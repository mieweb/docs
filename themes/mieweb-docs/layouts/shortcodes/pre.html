{{- /* Pre shortcode - code block with optional language and title */}}
{{- $language := .Get "language" | default "" -}}
{{- $title := .Get "title" | default "" -}}
{{- /* Clean the inner content - remove markdown code fences if present */ -}}
{{- $content := .Inner | replaceRE "(?s)^\\s*```[a-z]*\\s*" "" | replaceRE "(?s)\\s*```\\s*$" "" | replaceRE "(?s)^\\s*````[a-z]*\\s*" "" | replaceRE "(?s)\\s*````\\s*$" "" | strings.TrimSpace -}}
{{- if $title }}
<div class="my-6 overflow-hidden rounded-lg border border-border">
  <div class="flex items-center gap-2 bg-muted px-4 py-2 text-sm font-medium text-muted-foreground">
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
    <span>{{ $title }}</span>
  </div>
  <pre class="m-0 rounded-none border-0 bg-muted p-4 text-sm overflow-x-auto"><code{{ if $language }} class="language-{{ $language }}"{{ end }}>{{ $content | htmlEscape }}</code></pre>
</div>
{{- else }}
<pre class="my-6 overflow-hidden rounded-lg border border-border bg-muted p-4 text-sm overflow-x-auto"><code{{ if $language }} class="language-{{ $language }}"{{ end }}>{{ $content | htmlEscape }}</code></pre>
{{- end -}}
